import {
  require_client
} from "./chunk-TOVSBRWF.js";
import "./chunk-A7ECLLTJ.js";
import {
  require_react
} from "./chunk-HSUUC2QV.js";
import {
  __toESM
} from "./chunk-DC5AMYBS.js";

// node_modules/vitest-browser-react/dist/chunk-GRK6YIEP.js
var import_react = __toESM(require_react(), 1);
var import_client = __toESM(require_client(), 1);
import { debug, getElementLocatorSelectors } from "@vitest/browser/utils";
var mountedContainers = /* @__PURE__ */ new Set();
var mountedRootEntries = [];
function render(ui, { container, baseElement, wrapper: WrapperComponent } = {}) {
  if (!baseElement) {
    baseElement = document.body;
  }
  if (!container) {
    container = baseElement.appendChild(document.createElement("div"));
  }
  let root;
  if (!mountedContainers.has(container)) {
    root = createConcurrentRoot(container);
    mountedRootEntries.push({ container, root });
    mountedContainers.add(container);
  } else {
    mountedRootEntries.forEach((rootEntry) => {
      if (rootEntry.container === container) {
        root = rootEntry.root;
      }
    });
  }
  root.render(
    strictModeIfNeeded(wrapUiIfNeeded(ui, WrapperComponent))
  );
  return {
    container,
    baseElement,
    debug: (el, maxLength, options) => debug(el, maxLength, options),
    unmount: () => {
      root.unmount();
    },
    rerender: (newUi) => {
      root.render(
        strictModeIfNeeded(wrapUiIfNeeded(newUi, WrapperComponent))
      );
    },
    asFragment: () => {
      return document.createRange().createContextualFragment(container.innerHTML);
    },
    ...getElementLocatorSelectors(baseElement)
  };
}
function cleanup() {
  mountedRootEntries.forEach(({ root, container }) => {
    root.unmount();
    if (container.parentNode === document.body) {
      document.body.removeChild(container);
    }
  });
  mountedRootEntries.length = 0;
  mountedContainers.clear();
}
function createConcurrentRoot(container) {
  const root = import_client.default.createRoot(container);
  return {
    render(element) {
      root.render(element);
    },
    unmount() {
      root.unmount();
    }
  };
}
var config = {
  reactStrictMode: false
};
function strictModeIfNeeded(innerElement) {
  return config.reactStrictMode ? import_react.default.createElement(import_react.default.StrictMode, null, innerElement) : innerElement;
}
function wrapUiIfNeeded(innerElement, wrapperComponent) {
  return wrapperComponent ? import_react.default.createElement(wrapperComponent, null, innerElement) : innerElement;
}

// node_modules/vitest-browser-react/dist/index.js
import { page } from "@vitest/browser/context";
import { beforeEach } from "vitest";
page.extend({
  render,
  [Symbol.for("vitest:component-cleanup")]: cleanup
});
beforeEach(() => {
  cleanup();
});
export {
  cleanup,
  render
};
//# sourceMappingURL=vitest-browser-react.js.map
